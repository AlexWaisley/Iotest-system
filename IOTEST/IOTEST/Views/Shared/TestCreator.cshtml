@model IOTEST.IoContext.User
@{
    ViewData["Title"] = "IOTEST - Test Creator";
}

@section ScriptsBefore
{
    <script src="lib/Pixijs/pixi.js"></script>
    <script src="js/TestCore.js" asp-append-version="true"></script>
}

@section ScriptsAfter
{
    <script src="js/TestCreator.js" asp-append-version="true" type="module"></script>
}

<header>
    <nav class="navbar navbar-dark" style="background-color:rgba(45, 51, 51, 0.50)">
        <div class="container-fluid ">
            <a class="navbar-brand user-select-none DOB d-none d-sm-block" href="/">
                <img src="~/Icons/144x144.png" alt="" width="35" height="35" class="d-inline-block align-top">
                <span>
                    TEST system
                </span>
            </a>
            <span class="DOB navbar-brand float-left ml-auto user-select-none border-1 border-dark" style="cursor: pointer" v-on:click="location.href='/me'">
                <span class="mr-1">@Model.FirstName</span>
                <span class="mr-2">@Model.FamilyName</span>
                <img src="@Model.Image" alt="" width="35" height="35" class="d-inline-block align-top rounded-circle">
            </span>
        </div>
    </nav>
</header>
<script>
const MyMail = "@Model.Gmail";
</script>
<div id="Page" class="user-select-none container-fluid" v-cloak>
    <div class="row mt-1">
        <div class="col-10 offset-1  DOB" style="background-color:rgba(45, 51, 51, 0.50)">
            <div class="row">
                <div class="col-3">
                    <div class="text-left row pt-2">
                        <h4 class="text-light mt-2 text-center text-md-left">Ресурсы</h4>
                        <hr class="bg-light my-2"/>
                    </div>
                    <div class="flex-row justify-content-center">
                        <div v-if="MenuMode == 0">
                            <div>
                                <div class="p-3">
                                    <a class="btn btn-outline-light" v-on:click="MenuMode = 1">Управление ресурсами</a>
                                </div>
                                <div class="p-3">
                                    <a class="btn btn-outline-light" v-on:click="MenuMode = 2">Добавить</a>
                                </div>
                                <div class="p-3">
                                    <a class="btn btn-outline-light" v-on:click="AddElement">Настройки</a>
                                </div>
                            </div>
                        </div>
                        <div v-if="MenuMode == 1">
                            <div>
                                <div v-if="Core!=null">
                                    <div v-if="AddResourceMode===0">
                                        <div style="max-height: 40vh; overflow-y:auto;overflow-x: hidden">
                                            <div v-for="r in Core.Resources">
                                                <div class="p-1 row">
                                                    <div class="col-12">
                                                        <h6 class="text-light text-center">{{r.Name}}</h6>
                                                    </div>
                                                    <div class="col-4 offset-4">
                                                        <img class="img-fluid bg-light" src="" v-bind:src="r.Url" alt="">
                                                    </div>
                                                </div>
                                                <hr>
                                            </div>
                                        </div>
                                        <div class="p-1">
                                            <a class="btn btn-outline-light" v-on:click="AddResource()">Список</a>
                                        </div>
                                        <div class="p-1">
                                            <a class="btn btn-outline-light" v-on:click="MenuMode = 0">Назад</a>
                                        </div>
                                    </div>
                                    <div v-if="AddResourceMode===1">
                                        <div style="max-height: 40vh; overflow-y:auto;overflow-x: hidden">
                                            <div v-for="(r,i) in ResourcesAw" v-on:click="AddResourcesSelect(r)">
                                                <div class="p-1 row" v-bind:class="{'bg-success':(ResourcesAwSelected.includes(r))}">
                                                    <div class="col-12">
                                                        <h6 class="text-light text-center">{{r.Name}}</h6>
                                                    </div>
                                                    <div class="col-4 offset-4">
                                                        <img class="img-fluid bg-light" src="" v-bind:src="r.Url" alt="">
                                                    </div>
                                                </div>
                                                <hr>
                                            </div>
                                        </div>
                                        <div class="p-1">
                                            <div class="row">
                                                <a class="btn btn-outline-light col-10 offset-1" v-on:click="AddResources()">Добавить</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                        <div v-if="MenuMode == 2">
                            <div>
                                <div class="p-3">
                                    <a class="btn btn-outline-light" v-on:click="AddObjectMenu(true)">Добавить объект</a>
                                </div>
                                <div class="p-3">
                                    <a class="btn btn-outline-light" v-on:click="AddElement">Добавить тригер</a>
                                </div>
                                <div class="p-3">
                                    <a class="btn btn-outline-light" v-on:click="AddElement">Добавить анимацию</a>
                                </div>
                            </div>
                        </div>
                        <div v-if="MenuMode == 20">
                            <div class="p-3 row">
                                <div>
                                                        
                                </div>
                                <div class="col-4">
                                    <h3 class="text-light text-center">X:</h3>
                                </div>
                                <div class="col-6">
                                    <input v-model="nObj.X" min="0" step="50" type="number" class="form-control text-center bg-dark text-light border-1 border-light"/>
                                </div>
                                <div class="col-4">
                                    <h3 class="text-light text-center">Y:</h3>
                                </div>
                                <div class="col-6">
                                    <input v-model="nObj.Y" min="0" step="50" type="number" class="form-control text-center bg-dark text-light border-1 border-light"/>
                                </div>
                                <div class="col-4">
                                    <h6 class="text-light text-center">X Scale:</h6>
                                </div>
                                <div class="col-6">
                                    <input v-model="nObj.ScaleX" min="0.01" step="0.05" type="number" class="form-control text-center bg-dark text-light border-1 border-light"/>
                                </div>
                                <div class="col-4">
                                    <h6 class="text-light text-center">Y Scale:</h6>
                                </div>
                                <div class="col-6">
                                    <input v-model="nObj.ScaleY" min="0.01" step="0.05" type="number" class="form-control text-center bg-dark text-light border-1 border-light"/>
                                </div>
                            </div>
                            <div class="p-3">
                                <a class="btn btn-outline-light" v-on:click="AddElement">Добавить</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-7">
                    <div>
                        <div id="TestHead" class="text-left row pt-2">
                            <h4 class="text-light mt-2 text-center text-md-left" v-if="Core">{{Core.Name}}</h4>
                            <hr class="bg-light my-2"/>
                        </div>
                        <div id="TestMain" class="text-center text-light  DOB">
                            <div id="InteractiveBlock">
                                <canvas id="TestCanvas"></canvas>
                            </div>
                        </div>
                        <div id="TestFooter" class="text-left  pt-2 mt-0  row">
                            <hr class="bg-light md-2 mt-0"/>
                        </div>
                    </div>
                </div>
                <div class="col-2" v-if="Core">
                    <div class="text-left row pt-2">
                        <h4 class="text-light mt-2 text-center text-md-left">Сцена</h4>
                        <hr class="bg-light my-2"/>
                    </div>
                    <div>
                        <div style="overflow-x: hidden; overflow-y: auto; max-height: 400px">
                            <div v-for="obj in Core.Request('getObjects')" v-if="obj.Resource">
                                <div class="p-1 row">
                                    <div class="col-12">
                                        <h6 class="text-light text-center">{{obj.Resource.Name}} - {{obj.Id}}</h6>
                                        <div class="con">
                                            <div class="row">
                                                <div class="col-4">
                                                    <img src="~/Images/application.svg" class="" width="32" height="32" alt="" v-on:click="DestroyObject(obj)">
                                                </div>
                                                <div class="col-4">
                                                    <img class="img-fluid bg-light" style="min-height: 35px;min-width: 35px" src="" v-bind:src="obj.Resource.Url" alt="">
                                                </div>
                                                <div class="col-4">
                                                    <img src="~/Images/trash.svg" class="" width="32" height="32" alt="" v-on:click="DestroyObject(obj)">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <hr>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>